---
output: html_document
editor_options: 
  chunk_output_type: console
---

# Section 4: Spatial Haplotype Sharing
```{r, include=FALSE}
knitr::opts_chunk$set(echo = T, warning = F, message = F, eval = T, results = 'hide',
                      fig.align = 'center', fig.width = 8, fig.height = 8)
```


```{r}
library(tidyverse)
library(sf)
library(rgeos)
library(rworldmap)
library(tidygraph)
library(ape)
set.seed(48)
```


```{r}
#---------------------------------------------------- 
# Read In
#---------------------------------------------------- 


```


```{r}
#---------------------------------------------------- 
# Get Country Centroids
#---------------------------------------------------- 
# https://gis.stackexchange.com/questions/71921/list-of-central-coordinates-centroid-for-all-countries
wmap <- rworldmap::getMap(resolution="high")
centroids <- rgeos::gCentroid(wmap, byid=TRUE)
df <- as.data.frame(centroids)
df$country <- rownames(df)

# liftover country codes
df$country <- countrycode::countrycode(sourcevar = df$country, 
                                       origin = "country.name",
                                       destination = "iso2c")



```





festtableprune <- df
festtableprune$f_ind_est[festtableprune$f_ind_est < 0.8] <- NA
festtableprune$f_ind_est[festtableprune$f_ind_est > 1] <- NA
festtableprune <- festtableprune[,!colnames(festtableprune) %in% c("f_pop_est")]
#festtableprune <- na.omit(festtableprune)
colnames(festtableprune)[1:2] <- c("samp1", "samp2")

festtableprune <- festtableprune %>% 
  dplyr::mutate(F_est = f_ind_est) 


f.graph <- as_tbl_graph(festtableprune, directed = FALSE)
